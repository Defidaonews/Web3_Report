# 第二章 基础设施（公链）


Web3 的革命或许很久以前就开始了，但是区块链历史的纪元却从比特币诞生的 2009 年才开始。在这场以区块链为标志性开端的革命中，公链无疑是最重要的基础。从比特币的 PoW，转向加载智能合约的 ETH 1.0，再转向 PoS 的各个 L1 网络。公链在这 13 年中已经有了三次重大的迭代。现今的 Web3 是一个三种模式混合的系统，各个模式的公链各有千秋，繁荣共存。

#### 第 1 节 比特币的“罗生门”

这已经是比特币(BTC)的第四个减半周期了。随着比特币的区块不断增高，我们越来越难越说清比特币到底是什么。有太多的意义被加在了这个 09 年诞生的“币”上了。所以只能在不断变换的视角下，观察着比特币的“罗生门”。

**1.1 BTC vs 法币**

比特币狂热者们依然坚信比特币会取代法币，成为世界通用的支付工具。正如比特币白皮书里写的那样：一种点对点的支付系统。而2021年9月萨尔瓦多首先承认比特币作为国家法定货币之一也给了比特币的支付信徒们很大的鼓舞。

但是这种自上而下的比特币推广却受到了自下而上的抵制。有反比特币的抗议游行，还有相当部分的人仅仅下载了钱包进行30美元的初次领取就不再使用，零售商家采用的比例也不高。

萨尔瓦多原计划在今年3月出售的10亿美元比特币“火山债券”也还未上市。其他国家也在考虑接纳比特币成为法定货币，但是只有中非共和国官宣了此事。

比特币是否有朝一日能取代法币？比特币能否取代美元的世界货币地位？国际清算银行在2022年6月12日发布的《未来货币体系》（The Future Monetary System）年度经济报告特别篇中认为不会。各国的政府和监管机构也都认为不可能。

或许是这样，但是BTC带来的支付系统和钱包却可能给缺乏银行账户的人们带来享受金融服务的机会。事实上，即使萨尔瓦多可能最终没能普及比特币，但是他们推广的比特币闪电网络的钱包却也让相当的当地人收到了海外亲人的美元汇款。他们至少多了一种选择。

**1.2 BTC vs Assets (Gold & Stock)**

一直以来，比特币都是“矿”。只不过个人的淘金时代已经过去，无论是出于什么样的原因，机构已经成为了“挖矿”的主力。

![](.gitbook/assets/1)

资料来源：Global Hashrate Distribution\
https://history.btc123.fans/hashrate/

2021 年的能源争议让部分国家清退了“挖矿”（比特币的验证机制 PoW 需要消耗能源进行随机性“解谜”创造区块）；部分国家禁止了虚拟货币交易；市场转熊；以太坊正转向 PoS……算力此消彼长，经历着一场场迁徙，却从未消失，正如它过去十几年中不断进行的一样。

比特币在最近 10 年中大部分时间一直蚕食着黄金的市场。而且无论外部市场如何，持有比特币都成了对抗风险的对冲资产。正如瑞·达利欧（Ray Dalio）和诸多投资家将比特币以小比例加入自己的投资组合中。

不过近几个月，情况似乎发生了变化，黄金有重新抬头的趋势。

![](.gitbook/assets/2)

资料来源：Woobull Charts\
https://charts.woobull.com/bitcoin-vs-gold/

而长期和美股市场保持低相关性的 BTC 在最近半年中却越来越和 Nasdaq，特别是大盘科技股的相关趋同。这说明对于 BTC 的资产属性，“矿”的属性在减弱，而科技股属性在增强。

**BTC 与 Nasdaq 指数相关性**

![](.gitbook/assets/3)

资料来源：Bloomberg\
https://www.bloomberg.com/news/articles/2022-04-11/bitcoin-s-correlation-with-big-tech-increases-to-record-chart

**1.3 BTC vs Crypto**

BTC 在区块链的视角下更多的代表了核心价值观。

就市值而言，BTC 常年占据整个市场的40%以上。牛市时，市场会转向其他代币，而在市场转熊的时候，BTC 的份额会增加。这也就造成了 BTC 是最后抵押物的认知。因而有了 PoS 可行是因为 PoW 可行的论述。

在区块链的结构上，PoW 的网络架构和验证机制在新的区块链开发中已经不再主流。但是，BTC 的主链在经过了多次硬分叉之后也确定自己的定位和价值观：极致的安全性和价值存储功能。支付的功能交由 L2 的闪电网络负责。智能合约则大多运行在ETH和其他的 L1 链上，并由跨链桥（或者中心化交易所）与BTC进行价值沟通。

2021年11月的 Taproot 升级姗姗来迟。但这给 BTC 带来了新的安全性隐私性和可扩展性，我们还没有看到主流的应用面世，但是 BTC 的世界无疑又变得充满想象力了些。

**1.4 BTC vs DAO**

除了提供了一种可信度最高的加密世界的原生资产，BTC 对于 Web3 的意义可能在于一种更新的组织方式。至少证明了一项需要大规模世界协同的工作可以是完全去信任的。人与机器，或者说人与人之间通过代码，有了一次成功的合作案例。

**1.5 BTC vs World**

在以前的 BTC 叙事中，人们称之为区块链世界的基石。这些年，基石上的区块链世界在变得越来越丰富。

而当下，这块基石更深刻地联结到了这个现实的物理世界，并对现实产生越来越多的影响，比如华尔街的金融机构、各国的监管部门、第三世界的平民、科技行业的玩家。而这些人的加入，又让 BTC 呈现出了和之前不一样的形态。

所以，BTC 变成了座桥，联结两个世界。一个虚拟，一个现实。

Somehow, WAGMI（也许，我们都会成功）。

#### 第 2 节 以太坊：智能合约平台

以太坊（Ethereum）是一个拥有智能合约功能的公共区块链平台，允许任何人在平台中建立去中心化应用。自从2009年比特币开启区块链时代以来，最具代表性的技术创新就是以太坊智能合约的出现，它为之后 DApp 的出现、DeFi 应用井喷以及 NFT 的热潮提供最坚实的底层基础。

**2.1 智能合约**

智能合约即可编程的合同，也就是一段自动执行的程序片段，智能合约产生应用价值有一个非常重要的前提条件，即有一个不可篡改的储存和执行层，让其不可被物理因素所破坏。

区块链所提供的不可篡改性，也让区块链与智能合约能天然的契合在一起，让区块链技术脱离了单纯的加密货币支付功能，具备图灵完备性，打破了比特币作为简单账本的局限性，实现了复杂的价值传递。与此同时，丰富的应用场景也对区块链性能提出了更大要求，间接催生了日后各种高性能公链和 Layer2项目。

目前，以太坊作为最大的智能合约平台，其合约语言 Solidity 是使用比例最高和最受欢迎的一类编程语言，利用 Solidity 语言构建的各类应用中，锁定的资产价值占到了整个DeFi总锁定价值（TVL）生态应用价值的85%。

**不同智能合约语言应用锁定价值比例**

![descript](.gitbook/assets/4)

资料来源：The Block

**主要公链与代表性的合约语言**

| **链名称**   | **合约语言** | **图灵完备性** |
| --------- | -------- | --------- |
| 比特币       | 脚本语言     | 否         |
| 以太坊       | Solidity | 是         |
| BNB（BSC）  | Solidity | 是         |
| Avalanche | Solidity | 是         |
| Solana    | Rust     | 是         |
| Cosmos    | Rust\Go  | 是         |
| Polkadot  | Rust     | 是         |
| Fantom    | Solidity | 是         |
| Polygon   | Solidity | 是         |
| Flow      | Cadence  | 是         |
| Dfinity   | Motoko   | 是         |
| Near      | Rust     | 是         |

以太坊生态应用集中在DeFi领域，主要包括：DEX（Uniswap）、借贷（Aave、Compound）、衍生品（dYdX）、稳定币（MakerDAO、Frax），其他应用主要分布在NFT和链游等领域。

目前，以太坊链上TVL为470亿美元，与联发科和快手市值相当，排名前三的生态应用分别为 MakerDAO、Lido 和 Uniswap，各自占到了以太坊TVL的 16.7%、10.3% 和 9.9%。

**以太坊 TVL 变化**

![descript](.gitbook/assets/5)

资料来源：DefiLlama

**2.2 以太坊与兼容 EVM 链**

兼容以太坊虚拟机 EVM，是当下很多公链和二层必要的选择。

作为生态最庞大同时开发者数量最多的公链，以太坊在整个公链领域都有着举足轻重的地位。目前，市场上活跃的公链以及 EVM 兼容链有上百条，但能形成各自生态护城河的很少，各个公链都从过去的唯 TPS 论转变为生态建设与资本激励双轮驱动。

以太坊生态发展始终一骑绝尘，伴随着以太坊合并以及最终分片的逐步推进，以太坊的不可替代性进一步强化，各个公链开始积极兼容以太坊，让开发者可以轻松实现 DAPP 的迁移与部署。由此，也形成了数量庞大的 EVM 兼容链生态，兼容 EVM 也让 DAPP 应用的多链部署变得简单。例如：

* **BNB Chain（BSC）**

2020年9月1日币安智能链上线，作为在 DeFi 之夏由交易所推出的首条兼容 EVM 公链，BSC 承接了来自币安平台的大部分流量，也成就了 BSC 在公链领域的一席之地，BSC 采用了类似 EOS 的 DPoS 机制，TPS 能达到以太坊的30-70倍，但有效节点数量仅有21个，去中心化程度和以太坊不在一个数量级。

* **Avalanche-C**

Avalanche 是一个可互操作，高度可扩展的去中心化公链网络，Avalanche 分 X链，C链，P链，其中，C 链是 EVM 兼容链，也是智能合约链；X 链是 DAG 结构，交易速度最快，主要用于转账；P 链是和节点相关的链，主要用于 Staking，类似波卡的中继链。

* **Fantom**

Fantom 是基于 DAG 技术并支持EVM兼容的高性能公链，凭借 Andre Cronje 的背景，Fantom 生态发展在过去的一年中迎来了爆发式额增长，但随着年初 Andre Cronje 的退圈，Fantom 也迎来了自己额至暗时刻，其 TVL 从最高的 118.1亿美元下跌到了如今的 9.8亿，降幅达 91.7%。

除此之外，原本对 EVM 不兼容的公链相继推出了兼容以太坊的二层，比如：Near 推出 Aurora、Polkadot 推出了 Moonbeam、Cosmos上的Evmos、Solana上的Neon等，目前主流公链基本都能兼容EVM，这也将进一步强化以太坊在加密领域的影响力。

**2.3 以太坊合并：从 PoW 到 PoS**

共识机制作为区块链底层组件的核心之一，它是维持区块链网络状态一致性的黄金准则，决定了记账权的归属与分配。目前公链的验证机制演化出了很多不同的版本，但从应用的广度上来说，主要还是分为 PoW 和 PoS 两大派别。

其中，PoW 主要以比特币为代表，PoS 主要以 BSC、Fantom 等新生代公链以及合并后的以太坊为代表。对于 PoS 机制来说，验证者将不再需要耗费巨大的算力去争夺记账权，只需要在被随机选中时创建和提交区块，或是在没有被选中时验证他人所提交的区块的方式来获得奖励。

而以太坊合并指的是以太坊主网和信标链进行合并（The Merge），按照以太坊基金会的说法是：共识层与执行层合并，共识层即信标链，执行层指现有与以太坊进行交互层级。合并是以太坊过渡到分片时代的重要一步，合并后，以太坊将舍弃现有执行层的 PoW 部分，全面转向 PoS 时代。届时，以太坊网络将由质押者来进行区块打包和验证，PoW节点矿工以及算力矿机将会退出历史舞台。

以太坊网络的低扩展性、高能耗、高 GAS 等问题严重制约了其生态的发展，分片作为解决上述问题的最优解，推进分片的落地也成为以太坊未来发展的重中之重，而合并是构建分片的前提和基础。

其实，由现在的 PoW 过渡到 PoS 早就体现在了以太坊的发展路线图中，其中，难度炸弹的设定便是为了进行共识机制转换所设定的一项特殊机制，目的是推动 PoW 矿工转向 PoS，“难度炸弹”是一种根据区块时间调整链难度的机制算法，伴随区块高度的增加，出块难度会呈现指数级别的增长，最终的结果就是矿工在衡量成本后无利可图而退出，从 PoW 转向 PoS。因为合并一再推迟，难度炸弹已经被推迟过数次，2022 年 6 月，灰色冰川（Grey Glacier）硬分叉的推出，也预示着以太坊的合并至少在 9 月之后才会发生。

合并之后所带来的改变主要有三点。

首先，以太坊 Token 产出大幅降低。PoW 机制下，以太坊每天产出约 1.2 万枚，转为 PoS 后，每天产出仅为 1280 枚，降幅达 89.3%，加之 EIP-1559 的燃烧机制的存在，以太坊可能会全面走向通缩。

其次，降低了验证者门槛，有利于网络的进一步去中心化。在过去的 PoW 机制之下，验证者需要需要专业机器硬件，一般用户难以进入，但在 PoS 机制下，验证者不再比拼算力，对硬件标准大幅地降低，满足质押条件即可运行自己的节点，参与节点网络的运行。加之各类质押服务商的出现，进一步降低了成为以太坊验证者的门槛。

最后，大幅降低能耗，逐步迈向碳中和时代。PoS 机制下摆脱了对于高算力矿机的持续追求，会带来对于电力需求的大幅下降。目前以太坊网络的一年能源消耗大约为 51.32 TWh，与葡萄牙一个国家的能源相当，年产二氧化碳达 28.63 吨。据以太坊基金会测算，完成合并后，以太坊网络的能耗将下降 99.95%，每个节点一天的能耗将与一台家用电脑的耗电量相当。

**以太坊能耗指数**

![descript](.gitbook/assets/6)

资料来源：Digiconomist

需要强调的是，此次合并还不足以带来对于可扩展性和 gas 费用的改善，伴随之后分片的逐步落地才会带来交互上体验上的大幅改变。

#### 第 3 节 以太坊 Layer 2

为扩展以太坊网络性能，行业中先后诞生了各种扩容方案，按照所涉及协议层次不同，主要可以分为两大类：Layer 1 与 Layer 2。

Layer 1 即链上扩容，通常是通过改变区块容量或者底层数据结构等方式来实现性能的提升，以太坊的分片就属于Layer 1 扩容。分片又分为交易分片和状态分片，交易分片是指将数据的计算按照一定规则划分给不同分片节点处理，状态分片是指按照分片属性的不同将数据分开存储，通过在不同分片的并行处理来达到提升网络性能的目的。

Layer 2 一般指链下扩容，即数据计算、交易等业务迁移到主链之外的二层进行，降低对主链的负担，以达到提高交互速度和降低费用的目的。但如何确保链下二层数据的可用性与安全性，也就催生 ZK Rollup、Optimitic Rollup、Validium、Plasma 等不同的 Layer 2 扩容方案，在以太坊分片时代还未真正到来之前，Layer 2 将是以太坊扩容的最佳选择。目前，以太坊 Layer 2 主要以零知识汇总（ZK Rollup）和乐观汇总（Optimistic Rollup）两大 Rollup 解决方案为主。

Rollup，即汇总交易的意思，顾名思义就是将多笔交易数据汇总之后一次性提交到主链，以减少与主链的交互频率，达到减少网络拥堵、提升网络性能的目的。Rollup 方案下，能保证原始的交易数据记录在以太坊主链上，用户不再依赖特定的验证节点，是上述几种 Layer 2 方案中安全性最高的。

**3.1 ZK Rollup**

零知识汇总 ZK Rollup 于 2018 年首次被提出，它依靠零知识密码学来保障资金安全（既能充分证明自己是某种权益的合法拥有者，又不把有关的信息泄露出去，即给外界的“知识”为“零”），并将以太坊主链作为存储媒介和最终状态的确认，所以也继承了主链的安全属性。

ZK Rollup 方案下可保护用户的资金免遭没收和审查，但 ZK Rollup 的技术不成熟性和构建通用性网络难度大，也让 ZK Rollup方案的应用受到了很大的限制。对于ZK Rollup 的采用者来说，创建一个通用的 EVM 执行环境难度要比Optimistic Rollup高很多，ZK Rollup的典型代表项目就是zkSync和StarkNet。

* **zkSync**

zkSync由 Matter Labs 团队开发，完全兼容 EVM 的通用 2.0 测试网已经上线，在 zkSync 2.0 中，L2 状态分为具有链上数据可用性的 zkRollup 和具有链下数据可用性的 zkPorter，类似StarkWare旗下的StarkNet和StarkEx。官方公布的链上生态项目已有近100余个，集中在基础设施、跨链桥和DeFi领域，在 zkSync 网络中，支付gas 中可以用其他代币代替，无需一定要使用 ETH。

* **StarkNet**

StarkNet 是由 StarkWare 主导研发的 Layer 2 扩容通用平台，虽然与 zkSync 同属于 ZK Rollup 一族，但方案上有些许不同，前者使用 zk-SNARKs，所需的链上存储空间和 gas 费相对要小，后者采用的是 zk-STARKs，在网络安全性上更胜一筹。

5月 StarkNet 以 80 亿美元估值完成 1 亿美元融资，成为了目前所有 Layer 2 项目估值最高的一个，目前，StarkWare 正在积极测试官网 L1-L2 桥starkgate，预计在不久之后 StarkNet 网络会正式开放，StarkNet 官网上展示的生态项目有70余个，主要集中在 DeFi 领域。

**3.2 Optimitic Rollup**

Optimistic Rollup 所采用的不是零知识证明，而是欺诈证明，它借鉴了早期的 Plasma 扩容技术，依靠验证节点和挑战者间的博弈来保障资金安全，所以，当验证节点把 L2 上的交易数据最终状态返回至主链时，会进入一个7天左右的挑战期，挑战期内资金会被锁定，如果被验证交易数据有问题，其他的验证节点可提交欺诈证明，并将获得原验证节点的质押金。

相比 ZK Rollup，Optimistic Rollup 很显著的一个优点就是可以兼容比较复杂的智能合约，这也造就了目前已上线并形成应用规模的 Layer 2 项目都属于Optimistic Rollup 的版图，比如：

* **Optimism**

Optimism 是第一个开发 EVM 兼容的 Optimistic Rollup 解决方案，它通过单轮交互型欺诈证明保证同步到 Layer 1 的数据是有效的，这是它与 Arbitrum 方案的主要区别，同时 Optimism 也是四大主流 Layer 2 中首个发行 Token 的项目。

* **Arbitrum**

Arbitrum 由 OffChainLabs 团队开发，诞生于普林斯顿大学，目前是所有Layer 2 项目中生态发展最为完备，TVL 最高的项目。Arbitrum 采用的多轮交互欺诈证明，即在验证者提交欺诈证明后， Arbitrum 会首先在二层通过多轮交互，缩小争议范围后才会上主链进行模拟，来减少了链上解决争议的成本，这是它与 Optimism 方案主要的区别。

**3.3 Validium与Plasma**

* **Validium (StarkEx)**

Validium 是由零知识证明研发机构 StarkWare 主导研发的混合扩容方式，它与 ZK Rollup 的方案很类似，很关键的一点不同是 Validium 的交易数据并没有像 ZK Rollup 每笔数据都会存在主链上，虽然在链上发布了有效性证明，但数据储存是在链外，安全性不如 ZK Rollup 方案，比如 StarkEx Validium 的运营者是可以冻结用户的资金的。

此外，它对通用计算和智能合约的支持有限，生成零知识证明需要很高的计算能力对于低吞吐量的应用程序来说不具成本效益。而它的优势主要体现在没有提款延迟、有非常高的吞吐量（TPS约为1万），应用这一方案的代表性项目有：Immutable，DeversiFi。

* **Plasma**

2017年 Plasma 曾是以太坊扩容方案领域的主流，属于早期的扩容技术，目前，伴随 Rollup 方案的成熟，Plasma 作为一个安全性不太高 Layer 2方案逐渐走出了人们的视野。

Plasma 方案中，借鉴了过去比特币闪电网络的技术，它有一条独立的区块链，锚定以太坊主链，并使用欺诈证明来仲裁争议。它的优点是高吞吐量，每笔交易成本较低，缺点也很明显，难以支持通用计算，只支持特定逻辑的基本通证转账、兑换和等几种交易类型，此外，它还需要定期监视或者委托其他人监视网络，来确保资金安全。最具代表性的 Plasma 扩容方案就是 OMG Network。

纵观上述的 Layer 2 方案，我们能发现，Layer 2 扩容本质还是在安全、性能和去中心三个角度上的不同取舍，并由此衍生不同的方案。

**四种 Layer 2 方案的差异**

| **Layer 2 方案**    | **证明机制** | **安全性** | **可扩展性** | **代表项目**                |
| ----------------- | -------- | ------- | -------- | ----------------------- |
| ZK Rollup         | 零知识证明    | 高       | 低        | zkSync/StarkNet         |
| Optimistic Rollup | 欺诈证明     | 中       | 高        | Optimism/Arbitrum/Metis |
| Validium          | 零知识证明    | 低       | 中        | Immutable/DeversiFi     |
| Plasma            | 欺诈证明     | 低       | 低        | OMG Network             |

#### 第 4 节 Avalanche：雪崩协议、EVM、子网

Avalanche 主打高性能和高拓展性，前者通过雪崩协议本身的设计实现，后者通过支持开发者部署可自定义的子网实现。同时 Avalanche 对 EVM 有高兼容性，以吸引以太坊生态成熟的协议进驻，方便开发者建立 Avalanche 的原生协议。

**4.1 雪崩协议**

根据 Team Rocket （2018）的研究，雪崩协议的共识过程正如其名，雪崩一开始是随机崩塌（随机样本结果统计），最后大面积崩塌（即共识形成）。它的核心理念是通过不断反复对网络中的节点进行抽样并收集它们对某个提议的响应，最后可以把所有的诚实节点导向到同一个共识结果。

雪崩协议的优点有：高性能、低延迟、抗拜占庭攻击、抗双花攻击、矿工利益和用户利益不交叉、相对公平。

可能存在的问题有：

* **随机抽样达到的是非确定性共识。**
* **冲突交易不受保护。**
* **需要大量参与者的支持。**

（详见：ipfs.io/ipfs/QmUy4jh5mGNZvLkjies1RWM4YuvJh5o2FYopNPVYwrRVGV）

**4.2 Avalanche 的设计与原生跨链桥**

![Primary network](.gitbook/assets/7)

资料来源：Avalanche 官网

Avalanche 主网由三条链组成：

1. 负责创建资产及交易的 X 链（Exchange Chain）；
2. 负责储存链上数据，协调节点，建立子网的 P 链（Platform Chain）；
3. 负责执行智能合约，支持 EVM 的 C 链（Contract Chain）。

原生跨链桥 Avalanche Bridge 支持以太坊生态的资产跨链至 Avalanche 上，近期加入对 BTC 的原生跨链支持，以供BTC资产在 Avalanche DeFi 生态中使用。

**4.3 生态**

Avalanche 对以太坊生态极高的兼容度和基金会对生态的持续激励，吸引了大量以太坊原生的项目进驻，以及诞生了许多 Avalanche 原生的协议生态。用户仅需使用小狐狸钱包（MetaMask）添加 Avalanche-C 链即可参与 Avalanche 的生态。

Avalanche 上目前有 28 亿美元的 TVL，排名前五的 DAPP 分别是：

* Aave（以太坊原生，跨链部署至 Avalanche 的借贷协议）
* Trader Joe（Avalanche 原生的 DEX）
* Wonderland（Avalanche 原生的 DeFi 2.0 协议，即 OlympusDAO fork）
* Benqi（Avalanche 原生的借贷协议）
* Platypus Finance（Avalanche 原生的稳定币兑换）

其他有特色的原生协议例如:

* Avalaunch（Avalanche 上最大的 Launchpad ）
* Crabada（Avalanche上曾经最活跃的 GameFi 协议）
* Yeti Finance（Avalanche 上的借贷协议，支持杠杆）
* Yield Yak（Avalanche 上的收益聚合器）
* Step.app（Avalanche 上的 M2E 项目）
* Ascenders（Avalanche 上的 RPG 类型 GameFi 项目）

**4.4 子网（Subnet）**

Avalanche 支持开发者将 DAPP 部署至 Avalanche 子网，以建立自己的多链应用链网络。

子网部署简便，EVM 兼容，安全性使用的是 Avalanche 的“验证人池指定子集”，部分共享安全；子网之间目前无法直接通信，更适合可组合性不高，自成体系的 DAPP 协议。首个部署 Avalanche 子网的项目为 DeFi Kingdom。后续还有 Crabada，Step.app，Ascenders 等项目计划采用 Avalanche 子网。

#### 第 5 节 BNB Chain：币安、EVM、BAS

BNB 链与当前世界最大的中心化交易所币安关系紧密，采用EVM兼容架构，并开发 BAS 侧链。

**5.1 架构**

![BSC 2022](.gitbook/assets/8)

来源：Binance Blog

BNB 信标链：负责 BNB 链的治理（质押、投票）

BNB 智能链（BSC）：兼容 EVM，共识层，连接多链的中心

BNB 侧链：使用现有的 BSC 功能开发定制化区块链和 DAPP 的 PoS 解决方案

BNB ZkRollup（即将到来）：ZkRollup 解决方案能将 BSC 扩展为超高性能区块链

BSC Partition Chain 分区链（BPC）：类似以太坊 L2，用于承载 BNB Beacon 链的一些计算

**5.2 BNB**

与其他公链的主要代币不同，BNB 不仅是 BSC 链的主要代币，同时也是币安交易所的平台代币。BNB 除了受到 BSC 链的活跃度影响，也和币安交易所的活动与业务营收息息相关。

BNB 于去年11月通过了 BEP-95 提案的燃烧计划，BNB 燃烧总量的提案通过，长期并不利于 GameFi 类项目的复杂智能合约交互，可能会大幅提高该类项目的使用门槛。结合 BSC 对 BAS 的建立，猜测 BSC 链未来会主要把高频智能合约交互放在侧链进行。

**5.3 生态**

根据 DefiLlama 的数据，BSC 链上 TVL 现约为60亿美金，占全链链上 TVL 的7.8%。

![电子设备的屏幕

描述已自动生成](.gitbook/assets/9)

资料来源：DefiLlama

生态项目中，PancakeSwap 占据了 48.86%，TVL 占比前十的项目中，几乎都是 BSC 链的原生项目，且其中7个项目已上市币安交易所。

![](.gitbook/assets/10)

资料来源：DefiLlama

由于 BSC 相对较低的开发成本，在 BSC 上有大量生态项目开发活跃，21年11月一度达到 1600万的日交易哈希数。

![](.gitbook/assets/11)

资料来源：defiprime.com

BSC 链上有大量活跃的DeFi项目（例如 Tranchess），GameFi 项目（例如Binary X）和元宇宙项目（例如 SecondLive），唯一缺乏的是较为成熟的 NFT 交易市场。

BSC 对生态的发展设立有非常豪华的扶持，定期举办 MVB 计划评选出优秀生态项目并给予扶持，并于2021年10月推出了10亿美金的 BSC 生态激励。

**5.4 BAS 侧链**

根据 Mehta (2022) 的研究，每个 BAS 链都会有自己的 3-7 个验证人，预计会运行基于 PoS 的超级多数（2/3）共识。每个 BAS 链将使用自己的质押和实用代币来进行运作。此外，每个侧链的状态和状态转换将完全独立于其他侧链。

BAS 链将需要第三方桥接器来相互通信。在这种情况下，BSC 将利用 Celer 的第三方桥梁，通过「锁定 + 铸造」的形式，连接到每个 BAS，同时每个 BAS 也通过这种机制连接。（详见 Shanav K Mehta，Jump Crypto: _Flavors of Standalone Multichain Architecture_）

目前已确定参与 BAS 的项目有 Meta Apes （BSC 链原生的对战类 GameFi），Project Galaxy（多链部署的链上身份凭证项目）和 Cube（BSC 链原生的游戏平台）。

#### 第 6 节 Cosmos：开放架构、模块化和空投

_与其在一条公链上运行一个智能合约，和其他几千个智能合约争抢 gas 资源；为什么不在 Cosmos 上自己运行一条区块链，由公共的验证人提供共识？_

——Cosmos 官网

作为多链架构的创始项目，如果要只能用一个词来形容 Cosmos 的理念和生态，那么一定是：开放。

**6.1 开放架构：共享安全性和链间账户**

**Cosmos 架构示意图**

![](.gitbook/assets/12)

资料来源：X咨询\
https://0xzx.com/20190516205675959.html

在上图 Cosmos 的架构示意图中，最核心的部分是中间一层的 TenderMint 共识引擎。这种封装的共识生成模块理论上可以通过 ABCI（Application Blockchain Interface）被任何应用链调用。（注： ABCI即图中连接TenderMint 和上层中心 Cosmos Hub 的那根绿柱。）

上层的链分为两种：主打的“路由器”中继作用的 Hub 链和主打应用的其他 Zone 链。两种链由跨链 IBC（Inter-Blockchain Communication）协议来完成通信。而后跨链功能又更进一步，升级为链间账户，可以一站式完成不同链的操作。

理论上，这样的架构允许每一个 Zone 都可以通过 ABCI 相连到 TenderMint 上形成完全独立的链。但是，独立也就意味着自主。链的安全性如果没有足够的质押者就很容易遭到攻击。所以在官方推出了第一个 Hub，Cosmos Hub，之后很多 Zone 都选择直接连到其上共享 Cosmos Hub 链上的 $ATOM 庞大质押者带来的安全性，顺便再通过 Cosmos Hub 间接与其他所有生态中的 Zone 相连。所以 Cosmos 是作为一个整体共享安全性的。

**6.2 模块化的 Cosmos SDK 开发工具**

封装成一个个模块的 Cosmos SDK 工具箱可谓是对区块链应用开发者最友好的开发工具了。通过对于每个常用模块的调用，开发者可以快速完成自己应用的通用部分，并着重开发特殊的模块。同时，SDK 还对近期常用的模块进行标准化封装，供后来开发者使用，避免重复开发。

![](.gitbook/assets/13)

资料来源：cloud.tencent.com/developer/article/1446970

**6.3 空投**

由于共享安全性，新加入的应用链的验证工作很大程度上是由其他链完成的。所以为了回报这种贡献，新项目一般会对 $ATOM 和其他几条主要链（如 Osmosis, Juno, Secret）质押者的空投自己的代币。

而频繁的空投还带来另一个意想不到的结果：对于 DAO 空投机制的实验和思考，以及随之而来的治理改进。

几次重大空投包括：Osmosis（2021.7.4）；Juno（2021.8.27）；Evmos（2022.4.19）。其中，Juno的空投在之后还引发了关于DAO治理方式的重大争议。

**小结**

由开放、模块化和空投代表的 Cosmos 在很多人眼中有成为所有区块链底层 L0 的潜力，正如 Cosmos 的标签：区块链的互联网。但是这样的共识是需要一点点创建的，不知道世界给不给 Cosmos 这个时间。

#### 第 7 节 PolkaDot：中继链与平行链、插槽拍卖、黑客松

曾经的波卡被称为“跨链之王”，只是最近已经很少有人提及了。一方面是因为波卡本身的“野心”比跨链更大，波卡希望建立的是一个能传输所有区块链上所有数据的网络；另一方面，波卡目前的发展方向更偏重于自身生态的项目建设，发展模式和其他L1开始趋同。

**7.1 架构：中继链和平行链**

![](.gitbook/assets/14)

资料来源：波卡白皮书

波卡的多链生态中，所有的链分为中继链和平行链两种。在中继链的的层次上提供底层的 PoS 验证，共享计算和共识；平行链运行不同的应用，并由插槽（Slot）连接到中继链。而非平行链的其他链（比如 ETH 和 BTC）可以通过转接桥（Bridges，一种特殊的平行链，专门负责跨链）与中继链通信。

（技术细节详见波卡白皮书：polkadot.network/PolkaDotPaper.pdf）

**7.2 插槽拍卖**

为了使用中继链并加入波卡生态，项目方需要竞拍插槽位置（上限约为 100个），租期两年，竞拍成功的 $DOT 在此期间会被锁定。

插槽第一轮拍卖（2021.12）共质押有 9911.32万个 $DOT（占总量8.6%），Acala Network，Moonbeam Network，Astar Network，Parallel Finance，Clover Finance 这5个项目获得。

第二轮 Efinity、Centrifuge、Composable Finance、HydraDX、Interlay 和 Nodle 这6个项目以 2700万个 $DOT（占总量2.4%）赢得竞拍。和第一轮相比，平均花费少了 77.3%。

当然，波卡链的插槽数量是有限的（大约100个），所以，波卡生态还有很多和波卡链同构的先行网，像比较有名的 Kusama ，也在不断地进行着插槽拍卖。

**7.3 黑客松 Decoded**

从2020年起，波卡黑客松 Decoded每年会举办的，推广和发布项目最新动态。

**小结**

波卡经历了由“跨链之王”转向 L0 再转向了“类似L1”，从某种程度上也反映了区块链公链的设计思路转变。但是和区块记录的终局性不同，链的迭代和进化可以是无止境的。

#### 第 8 节 Solana：PoH、生态、宕机事件

在所有主流公链中，Solana 绝对算的上是独树一帜。从设计理念上看，Solana 像是“圈外”程序员们对于区块链同行的一次“反击”。特殊的异步 PoH 验证机制，Rust 的采用，完善统一的 DeFi 和 NFT 底层，还有互联网“喜闻乐见”的 DDOS 攻击，这一切都造成了 Solana 的特殊气质。

**8.1 机制：Rust，POH 与“三角取舍”**

Rust 在区块链中并不是主流，更多链的采用的是 EVM 的 Solidity 系统。但是在2020年一项针对开发人员的 Stack Overflow 调查显示，Rust 为「最受欢迎的编程语言」，大约 86% 的受访者表示他们希望在未来继续使用 Rust 进行编码。（参见 Supra Labs：《详解区块链编程语言：致雄心勃勃的开发人员》）

在2018年9月24日，Solana，Zcash 以及 Parity 的三方会谈中，Solana 创始人总结了 Rust 适合区块链开发的6点原因：（1）速度和C/C++一样快；（2）像Haskell般的类型安全；（3）没有垃圾回收器，变量出了作用域会自动被回收，释放内存；（4）杜绝了空指针和悬挂指针，这二者是导致C/C++系统崩溃，不安全代码的根源；（5）规则严谨；（6）实现并发编程。

Solana 的 PoH（Proof of History）共识机制是很有创新性的异步结构。

一般来说，区块链在状态更新时会要求全网同步。也就是说，所有的节点同步更新后才会出下一个区块。而这在一定程度上降低了每个节点的效率。为了最大程度地提升每个节点的性能，Solana 引入了一个分片式时钟和一个全局时钟.至此，状态的更新不再需要全局时间的同步，每个节点将周期性地将自己的时钟与全局时钟同步。

同时为了解决交易的信任问题，Solana 同时也引入 VDF（可验证延迟函数）。每个交易打包上链时PoH会记录一个时间戳，便于节点使用 VDF 验证链上操作的历史记录。

高效的 Rust 语言以及满负载运行节点的PoH共识铸造了“极速”的 Solana。区块链的不可能三角（去中心化，扩展性，安全性）中，比特币，以太坊的主网都舍弃了可扩展性，而 Solana 舍弃了去中心化。

目前 Solana 基金会是唯一在区块链上开发核心节点的实体。根据 Solana beach 的数据显示（https://solanabeach.io/），目前 Solana 的节点数量为1793个，中本聪系数为26（中本聪系数：让某一子系统妥协所需的最小实体数）。所以理论上，只需要26个节点就可以使 Solana 瘫痪。

**8.2 生态：Serum 和 Metaplex**

根据 Solana 官网信息，截至6.25，Solana 上 DeFi 有301个（其中DEX有175个，AMM 机制25个，Order Book 机制150个），而 NFT 项目有929个（其中Metaplex相关的有100个），Game 有271个。其中分为基于 Serum 的 DeFi 系统和基于Metaplex的NFT系统。

在 DeFi 项目中，有一半是 DEX，这得益于 Solana 上的 DeFi 基建 Serum。

Serum 是一个 Order Book 的 DEX，所有 Solana 上的 DEX 流动性都会集聚到Serum。换言之，如果任何一个 DEX 上的挂单，最终撮合交易的是 Serum，而你的对手方也是整个 Solana 上 DEX 的所有 Maker。这保证 Solana 上流动性的集中，交易的足够深度，以及所有的 DEX 都只是 Serum 的一个 GUI。

此外，Solana 与中心化交易所 FTX 的紧密关系也让 Serum 在事实上有机会共享部分的链下流动性。

和 DeFi 项目相比，Solana 上的 NFT 要多出两倍。从 NFT 基础设施上来说，这可能是当下最适合 NFT 的公链。

Solana 上的NFT底层协议 Metaplex，支持用户完成铸造，定价，发售的一站式流程。在这个万物皆可 NFT 的时代，大大降低了 NFT 的创造门槛。设计好愿景，讲好故事，NFT 便可上市。

所以，在以太坊NFT市场遇冷的时候，Solana 上的 NFT 热度不减反增。在市场低迷的5月，OpenSea（以太坊链）交易量环比下滑31.6%。而 Magic Eden（Solana 链上最大的NFT交易平台） 5月交易量环比增长39.79%，OpenSea（Solana）环比增长286.02%。

**8.3 宕机事件**

虽说 Solana 主推 TPS 高，交易处理速度快，但是却经常非常不稳定。以下列举了近期几次比较严重的主网事故：

* 2022.5.1，Solana 主网涌进了4m每秒的请求次数，导致节点内存不够停止出块，近七个小时没有出块。
* 2022.5.26，Solana 主网发生区块时钟偏移，链上计时与现实世界时间落后约30分钟。
* 2022.6.1，Solana 由于区块未能达成共识，主网中断约4.5小时。

期间还穿插着数十次“主网性能下降”。

（详情参见 https://status.solana.com/history，节点更新情况 Twitter：@SolanaStatus。）

究其原因是大部分新链游和NFT的铸造活动或者 Genesis NFT 售卖引来了大量的科学家和他们的机器人，伴随着各个机器人们每秒至少两位数的点击频率，Solana 持续遭受着 DDOS 攻击（大量无效请求导致正常请求无法被提交）。例如，5.1的宕机事件也是由于机器人攻击了 candy machine（Metaplex 推出的mint NFT的工具）导致的。前端时间 StepN 的过热也导致了 Solana 的拥堵。

目前 Solana 也引入了解决方案，如果一个钱包提交了无效的 NFT 交易，该钱包会被扣去 0.01 $Sol 作为惩罚。

这样看，Solana 问题的主要根源来自两点：底层技术和 NFT 的火热。Solana 或许能抗住 Defi 清算带来的套利机器人，但是却输给了 NFT 机器人。

**小结**

如果说高速异步是 Solana 最大的标签，那么宕机也就是它付出的代价。但相比于去年，Solana 的性能在逐步提升，TPS 有所恢复并且交易失败在减少。或许正如Solana Labs 创始人 Anatoly Yakovenko 所说的，这些只是“一次阵痛”。

得益于高速，DeFi，NFT和Game 也许可以带来一些意想不到的结合方式。

#### 第 9 节 中国区块链：数字藏品+联盟链

在2021年的监管事件之后，中国的区块链主要以数字藏品（NFT）平台为主；并且以节点数量有限并大多掌握在开发者手中的联盟链为主。经郭志浩律师统计的前100平台中，大厂数量并不少。

| **联盟链** | **开发者**                                                                                   | **使用平台**                                       |
| ------- | ----------------------------------------------------------------------------------------- | ---------------------------------------------- |
| 蚂蚁链     | 阿里                                                                                        | 鲸探、幻藏、超维空间、七级宇宙、蓝猫数字、一花yihua、第九空间、神秘绿洲、数旅人DT宇宙 |
| BSN联盟链  | 文昌链（基于IRITA）、泰安链（基于FISCO BCOS）、武汉链（基于Ethereum）、唐山链（基于DBChain）、广元链（基于Everscale）和中移链（基于EOS） | Mytrol数字文创、虎元元、数藏中国、河洛、千寻数藏                    |
| 至信链     | 腾讯                                                                                        | 幻核、TME数字藏品、R-数字藏品                              |
| 领御链     | 腾讯                                                                                        | 云岫数字藏品                                         |
| 百度超级链   | 百度                                                                                        | 百度超级链、洞壹元典、良选数字、元塑、麟境                          |
| 星火链     | 工业和信息化部                                                                                   | 斑马中国、阿里拍卖                                      |
| 天河链     | 天河国云                                                                                      | 优版权、博物链                                        |
| 骏途链     | 骏途网                                                                                       | Hi元宇宙                                          |
| 京东智臻链   | 京东                                                                                        | 灵稀、红果数藏                                        |
| 趣链      | 趣链科技                                                                                      | 红洞数藏、律核                                        |
| 网易区块链   | 网易                                                                                        | 网易星球                                           |
| 海斯匹链    | 米链科技                                                                                      | 草方格Square                                      |
| 元镜联盟链   | 杭州元镜科技                                                                                    | 西湖一号                                           |

资料来源：\
郭志浩 https://www.163.com/dy/article/H6PEPLNQ0552DGBG.html

但是也有使用ETH发行 NFT 的 Bilibili，Bigverse（NFT中国）等，以及使用Solana 和 Polygon 的公司。

在去中心化上，联盟链饱受争议。Meta（原Facebook）的 Libra 计划的失败似乎也是一个联盟链失败的例子。但是现在说Web3里容不下联盟链还为时尚早。

#### 总结

区块链的历史几乎可以等同于公链的历史。在不同的公链迭代中反映的其实是不同的社区群体对于当前世界的不同理解，和应对不同问题的不同解决方案。但和世界上所有的解决方案一样，旧的方案会成为新的问题。所以对于 Web3 的未来有一点是确定的，公链在很长一段时间都会成为底层核心，并且还会不断迭代。
