# 第三章 基础设施（扩展）


就区块链整体而言，公链还只是 MVP（最简可行产品，minimum viable product）。特别是在 ETH 开启了智能合约时代之后，从公链到直接应用还需要大量的“部件”来扩展公链的功能，使之能更方便的供开发者，研究者和普通用户使用。

#### 第 1 节 身份系统：私钥翻译器

从传统的角度理解，Web3 的身份系统就是账户。专业一点来说就是，一串私钥哈希值在分布式账本中所能一一对应的一切。

在这个账号（地址）由密码（私钥）不可逆生成的 Web3 世界，私钥就是最底层的身份。所有的 Web3 的行为主体，都围绕着私钥进行。（注：私钥通过椭圆曲线得出公钥，公钥通过哈希得出地址。）但问题是，“钥匙”的底层是哈希值——一段只有机器才能读懂的语言。

所以，身份系统（项目）就要给这段哈希值做翻译。而因为这是真正意义上的 Web3 入口，可以说是除了区块链公链本身最重要的基础设施。

**1.1 身份系统 v1.0：助记词和钱包**

私钥和助记词是一一对应的。比起哈希值，助记词已经可以记住了，虽然还是一些没有连贯意义的单词。在个人已经没法或者说不愿意运行“挖矿”（验证）节点的情况下，钱包应用让助记词成为私钥的第一层简化翻译。

而各条链由于底层的验证方式及私钥格式不同，都倾向于开发自己的钱包应用。而由于ETH和使用相同结构的EVM链（AVAX，BNB chain，Axie 等）以及 ETH 的 L2（Polygon，Aribitrum, Optimism）都能通用一个钱包。所以 MetaMask 也是所有钱包应用中最广泛使用的。

此外，Solana 上有 Phantom；Cosmos 上有 Keplr；Polkadot 上有 Polkadot JS。

**1.2 身份系统 v2.0：域名和隐私**

2.0 版本的身份系统主要是对地址的加强。地址是要给所有人看的，所以对于地址就有了两方面需要：在某些情况下（比如熟人转账）需要容易记住；在某些情况下（比如大额交易）需要隐私加密。

地址变得易记是通过购买一个域名 NFT，每个域名在同一时间只可能对应一个地址。比如 ETH 的 ENS，Solana 的 Bonfida，Flow 上的 MYNFT 都提供类似的功能。

隐私和地址的距离稍远，但是地址的本质是假名而非匿名。隐私就让地址匿名。比如混币平台 Tornado Cash；还有将隐私功能做进了区块链里的门罗币。

**1.3 身份系统 v3.0：KYC、灵魂代币、电子签名、多签**

当下 3.0 时代的身份系统在地址和私钥的对应上更进一步。

在对地址的对应上，已经有项目将社交账号和地址绑定的了（KYC）。比如域名项目里可以进一步添加 Twitter 账号。还有需要 Zoom 会议确认真人身份的 BrightID。同时铸造不可转账的“灵魂绑定”NFT也可以算是链上地址身份的衍生，比如 Rabbithole。

在私钥上，也不一定需要助记词。理论上只要能对应唯一私钥的一切信息都可以，生物信息（指纹，声音，人脸识别），法律文书（营业执照，法律证明）。虽然还没有成熟的项目，但已成趋势。

多签钱包目前大多为机构使用，是在仿照类似董事会的投票制度。比如每笔交易都要控制钱包的多数人签名同意才可执行。但是，在未来的链上资产继承可能会将多签的需要带给每个加密资产持有者。

#### 第 2 节 跨链桥

多链时代下，BSC、Polkadot、Avalanche、Fantom 等各个公链都形成了自身的生态图谱，伴随着 DeFi、NFT 和 GameFi 的蓬勃发展，资产跨链逐步成为了刚需。在链上资产对不同公链/Layer 2 上的利润追求下，在用户对不同链上应用的体验中，在开发者对多链应用的布局里，跨链桥也迎来了自己的黄金时代。作为一种桥接工具，跨链桥打破了不同公链/Layer 2 的生态孤岛，实现了资产在不同链间的转移和传递，也促进了多链生态之间的兼容。

总结来看，跨链桥的意义主要体现为以下几点：

* 提升了链上资产的利用率。跨链桥的出现，让链上资产可以便捷地在不同链之间的进行流转，能极大的提高资产的利用率，资产利用率的提升也将推动链上应用的发展。
* 为用户提供更多玩法。对于普通用户来说，跨链桥的出现实现了跨多个网络去体验不同应用的便捷方式，降低了体验操作的难度，能为用户提供更多的链上玩法。
* 成为多链协议的基础层。伴随着公链网络的繁荣发展，单一的区块链系统已经难以承载应用的发展需求，链与链之间的互操作性越发重要，通过跨链桥，各种 DAPP 可以基于多链功能提供更丰富的服务，同时也面向更多用户群体，来提升各自竞争力，在这个过程中跨链桥则成为多链协议的基础层。

**2.1 跨链模式**

当前跨链的模式主要由以下三种：

* **锁定+铸造**

锁定+铸造属于资产跨链最常用的方式之一，在跨链这个过程中，首先会将跨链资产锁定在源链的指定智能合约中，并在目标链铸造出等价值跨链资产，这个资产本质就是一个可赎回的凭证。这类跨链桥往往被用于向新链引入主流跨链资产，所以一般属于官方桥，比如 Avalanche Bridge。

* **双向资金池模式**

这是第三方桥常用的方式，也就是跨链桥预先在两侧设立一定的资金池，一边是源链的原始资产，一边是目标链的跨链资产，用户在跨链时，把资产转入源链合约地址，在目标链收取跨链资产，因为双向资金池一般都需要官方发行的跨链资产，所以往往需要等到官方桥建立后能部署。

* **原子互换**

通过依赖高度自我执行的智能合约来实现资产跨链，这是当前跨链模式中去中心化最高的。

从验证者角度来说，目前跨链桥大多采用的都是第三方验证模式。也就是在验证跨链信息中，会存在一个或多个第三方群体，当用户在使用跨链桥时，他们会监控源链上的信息，并对这些信息进行验证，一旦验证者达成共识，则会在目标链上生成相应的资产。

根据验证者多少的不同，又可以划分为多点验证和单点验证，有的跨链桥为了网络安全，同时防止验证者作恶，还会要求验证质押一定的资产。此外在多点验证中还会加入多签或者多方计算（MPC）等方式来提高安全性。

**部分跨链模式的异同**

| **名称**     | **验证机制**     | **资产跨链模式** | **多/单链桥** |
| ---------- | ------------ | ---------- | --------- |
| Hop        | 多点验证+资产质押    | 资金池模式      | 多         |
| Multichain | 多点验证+MPC     | 锁定+铸造      | 多         |
| Rainbow    | 轻客户端+中继验证    | 锁定+铸造      | 单         |
| cBridge    | 多点验证+多签+资产质押 | 原子置换       | 多         |
| Stargate   | 预言机+中继器      | 资金池模式      | 多         |
| Synapse    | 多点验证+MPC     | 资金池模式      | 多         |

伴随着跨链桥的发展，不同的跨链桥在不同的链之间会有各自的优势，也就造成了不同的跨链费用和跨链速度。从用户角度考虑，辗转与各种不同的跨链桥是一个积极反人性的操作，于是跨链聚合器开始出现，他通过聚合已有的跨链，自动匹配最合适的跨链链路，主要以 Li.Finance、XY Finance 等为代表。

此外，Cosmos 和波卡作为独特的“公链”，目前基于他们各自构建的多链生态也初具规模，而依靠各自的同构链底层协议跨链 IBC 和中继链，不仅能实现资产的跨链，跨链通信也变得极为容易，与上述跨链桥大多要依赖第三方不一样，Cosmos 和波卡的跨链都是属于原子级别的跨链，通过轻客户端+中继验证的方式，在安全级别是很高的，属于真正的资产跨链而不是资产价值的跨链。

**2.2 跨链桥安全**

从4月知名链游 Axie Ronin 桥被盗6亿美元，到最近 Harmony 的官方跨链桥Horizon 被盗1亿美元，跨链桥的安全问题已经成为制约其发展的重要因素，更引发了用户对跨链桥的集体信心缺失，当前跨链桥的安全问题主要的影响群体是验证者和LP的提供者。

常见的跨链桥漏洞主要出现在两个地方：一是跨链签名处，攻击者通过各种方式获取项目方或验证者的公私钥对，从而盗取资产；第二种是直接利用合约漏洞，比如此前的 Wormhole 跨链桥被盗事件，攻击者通过合约漏洞，欺骗了多重签名，并铸造出了 12 万 Wormhole ETH，盗取了大量的资产。

#### 第 3 节 分布式存储：机制、赛道、问题

分布式存储作为 Web3 的基础设施之一，它是大规模链上数据实现去中心的必要选择，特别是在解决服务器单点故障、数据丢失等方面有着得天独厚的优势。相比中心化的存储，分布式存储在隐私保护、数据安全、相应速度等方面都有非常的竞争优势。

**中心化存储 vs 分布式存储**

| 存储类型   | 数据安全 | 隐私保护 | 下载速度 | 闲置存储资源利用 | 存储激励 | 存储空间开销 |
| ------ | ---- | ---- | ---- | -------- | ---- | ------ |
| 中心化存储  | 弱    | 弱    | 慢    | 低        | 无    | 小      |
| 去中心化存储 | 强    | 强    | 快    | 高        | 强    | 大      |

资料来源：网络与信息安全学报

**Filecoin(IPFS)**

IPFS 协议由 Protocol Labs 实验室开发，作为一种新的传输协议，IPFS 对标是目前传统互联网常用的 HTTP 协议，Filecoin 则属于 IPFS 的激励层，旨在解决 IPFS 网络稳定和安全问题，通过激励机制吸引专业存储服务商来提供专业且安全的存储服务。

Filecoin 矿工分为存储矿工与检索矿工，分别承担存储文件和检索文件的服务，并从用户端收取费用。目前，Filecoin 正在积极推进FVM虚拟机，FVM 与以太坊 EVM 兼容，它在现有的存储层上引入智能合约的可编程性，做到智能化存储和可编程存储，这也让 Filecoin 在当前的存储赛道走出了一条差异化的竞争路线。

**Arweave**

Arweave 是一个永久存储协议，这也是它的存储特色。Arweave 网络通过随机访问的简洁证明（SPoRA）来鼓励矿工尽可能多地保存区块，Arweave 会首先随机选择一个Recall Block，只有保存过这个 Recall Block 区块的矿工才能参与之后的区块打包竞争，它通过这种机制，来实现数据从单一到大规模的复制，做到所说的永久存储。

但同时这也带来了一个问题，即数据冗余，特别是当面临数据爆炸等问题时，这个问题会更加明显，但目前，桎梏于公链性能的问题，对大规模存储的需求并不强烈，并不太会对存储空间提出太大的需求。

**Storj**

Storj 网络主要包括用户、卫星和节点三个角色，用户提出上传或下载数据的需求，节点负责执行，卫星则选择最快的节点，与此同时它还记录用户和节点的支出收入、储存位置、节点信誉等数据。据 Storj 自身的宣传地位，它主要锚定的是亚马逊 S3 的去中心化云存储平台，所以它的代币没有复杂的机制和经济模型，作为一个 2014 年诞生的项目，Storj 在发展前景和现有市场应用中都远不及上文的 Filecoin 与 Arweave。

目前，分布式存储对于Web3时代的作用还未体现出来，所存储的数据主要体现在NFT 图片、链上合同、链上图文等内存占比较小，交互频率较低的数据。但伴随元宇宙概念的快速发展，会带来视频、音频、数字模型等大体量数据存储的需求，为分布式存储带来新的发展契机。

与链上金融一样，分布式存储也面临着许多现实的问题：

首先，就是非法内容监管问题。区块链的不可篡改性也让非法内容的传播变得不可控，这也是制约当前分布式存储非常主要的一个问题。无论区块链极客拥有怎样的理想情怀，但始终是要在当前社会的法律和道德框架之下运行，所以，对于分布式存储来说，如何构建起一个从输入端到输出端的全链监管模型是其走向主流社会所必要面对的问题。

第二，如何提高分布式存储的存储空间利用率。当前的分布式数据存储存在很大一部分的垃圾数据和存储数据的冗余，一旦走向大规模应用，当前的分布式存储项目能否快速适应市场的极速变化还有待验证。

第三，目前，各去中心化存储项目并未给出存储的耐久性数据，这也是一个有待验证的领域。

#### 第 4 节 预言机：机制、赛道与应用场景

因为区块链无法自身与外部建立联系，区块链是无法自己获得链下数据的。这铸就了区块链比传统网络更安全的特性，但也因此它必须要通过中间层调用数据才能完成大部分的场景实现。而这个中间层就是“预言机”。

**4.1 机制**

区块链预言机是作为中间层链接链上链下两个世界。区块链能通过预言机连接到支付系统、数据提供商、交易所、云服务商、物联网设备以及其他区块链等各种链下环境。

根据Chainlink的总结，一般预言机都会具有以下几个关键功能：

* **等待响应**
* **获取数据**
* **格式化**
* **验证**
* **计算**
* **广播**
* **数据输出（可选）**

（详见：https://blog.chain.link/what-is-the-blockchain-oracle-problem-zh/）

**4.2 预言机赛道**

根据 IOSG Ventures 的分类，预言机一共可以分成以下4类：

| 软件预言机   | 互联网站提供的 API 接口                                                                                                                                               |
| ------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| 硬件预言机   | 如 IoT 中被广泛采用的电子传感器和数据收集器，以及各种条码扫描仪、银行卡 PoS 机、收集各种医疗数据的医疗设备等                                                                                                  |
| 中心化预言机  | 一般为政府或授信机构提供的第三方提供                                                                                                                                           |
| 去中心化预言机 | <p>基于聚合的处理方式：多数据源聚合消除单个恶意数据影响，如 Chainlink</p><p>基于质押的处理方式：要求参与者持有资产提高可信度，如 Band</p><p>基于博弈论的处理方式：提供非敌对的经济激励，如 NEST</p><p>基于信誉的处理方式：通过降低声誉限制敌对节点，如 Witnet</p> |

（详见IOSG文章：《预言机，让 Web3 变得更好了吗？》）

当前市场还是以 Chainlink 为首的去中心化预言机。虽然有效率与权威性的问题，但是去中心预言机能够避免其他三种预言机的单点估值问题。而且在 Chainlink 2.0 的白皮书中，一个理想的预言机网络（DON，Decentralized Oracle Network）可以囊括当前的所有4种数据获取方式，或者那才是预言机的终极形态。

![](.gitbook/assets/15)

资料来源：Chainlink 白皮书 2.0

**4.3 应用场景**

当前预言机在 Web3 中主要还集中于资产喂价领域，但是随着 Web3 扩展到更广阔的领域，预言机用例的增加也水到渠成。

* **DeFi：喂价与公平排序**

在 DeFi 中，除却我们耳熟能详的喂价功能，在预言机中出现了新的场景——公平排序（fair sequencing）。

在现有的交易环境中，每一笔交易是经过矿工的审查和排序的，而这也让他们有了极大的套利和操纵空间，比如我们耳熟能详的 MEV（矿工提取价值）。

公允排序包括两方面：一是排序按照节点接收交易的时间先后进行；二是保存交易之间的因果关系。所谓因果关系，是指隐藏交易数据，等到共识层完成排序后再披露交易顺序，以达到防止改变交易之间的因果关系。由此可知，公允排序服务可以有效消除抢跑交易。（参见 Chainlink 2.0白皮书：DON的公允排序服务FSS）

* **NFT & GameFi：随机数**

随机数可以说是 NFT 玩家和 GameFi 玩家的必需品。艺术家需要随机数随机生成稀有度不同的 NFT；Gamefi 玩家也需要一个公平公正的游戏规则来保证自己的权益不受到损伤。

而这里就需要保证随机数真实可信，而纯代码中是没有真随机数的。所以预言机的 VRF（Verifiable Random Function）功能通过在链下生成一连串可验证的真随机序列，然后提供给相应项目方使用，确保随机数的保密性和公平性。

* **CCIP：跨链信息**

CCIP（跨链互操作性协议）能为开发者提供开源的标准，轻松打造安全的跨链服务和应用。有了通用的消息传输接口，智能合约可以跨多个区块链网络通信，开发者无需为了接入某一条区块链专门编写代码，如 Chainlink 的Messaging Router。

* **DAO：身份认证**

在对抗女巫攻击（同一人创建多账户节点控制网络的攻击方式）的实践中，DID（去中心化身份认证）可以充分运用到 DON。

**小结**

预言机已悄然展开了新的叙事，从原本单一的喂价服务转变到提供各项新兴应用支持的多面插座。在 Web3 的虚实之间，预言机是其中不可或缺的重要一环，甚至在传统行业和政府机构进入 Web3 方面，预言机也是很好的切入点。

#### 第 5 节 稳定币的“救赎”

在 Luna 币断崖式崩盘事件之后，稳定币终于成为了压倒骆驼的最后一根稻草。但是 Web3 需要稳定币就像经济系统需要一般等价物。当“BTC 本位”已经更多的成为了一种价值取向，在 Web3 中以美元稳定币计价的“U本位”已是主流。

![](.gitbook/assets/16)

资料来源：CMC

**5.1 稳定币的定位**

稳定币是什么很容易回答：一种链上锚定现实法币价值的代币。

但是稳定币意味着什么却少有人提过。其实，稳定币和比特币有类似的定位：连接现实和虚拟的桥梁。

所以真问题在于，Web3 要选择什么样的稳定币。

**5.2 稳定币的类型**

* **链上的稳定币（算法稳定币和超额质押稳定币）**

这已经不是算法稳定币的第一次失败了（Basis、ESD、Titan），每一代的算法稳定币发行方都在试图扮演“中央银行”的角色，通过调节供应量稳定币价锚定。从历史来看，这比想象的要难的多（尽管有了 Curve 3-pool 4-pool，部分抵押等机制），甚至各国的央行都未必能在现实中做到。

超额质押生成的稳定币（例如 Dai）单次生成稳定币似乎降低了系统的风险（价值1000美元的 ETH 只能生成 800 个 DAI，ETH 价值下跌就会面临清算从市场中回收 DAI）。但是在多次循环借贷之下，却增加了杠杆率，扩大了系统风险。

链上资产生成的稳定币，在扩展信用的阶段确实能比其他稳定币更高效地提高资金利用率。所以不难理解市场上升期链上稳定币会发展迅速（例如 Terra & UST；Tron & USDD；Near & USN）。但作为一种链上信用想要锚定美元的代币，当链上和链下流动性同时收紧的时候，就是“死亡螺旋”的开始。

作为桥接链上下两端的资产，两端走势的趋同会削弱算法中的反脆弱性。而在当下，趋同正在发生。

* **中央银行的数字法币（CBDC）**

政府的数字法币可以解决稳定币的币值锚定问题。但是如果大规模接入公链在支付中采纳却没法保证风险可控不扩散，所以当下只能在有限的领域小规模试点应用。

但是在更大的维度上看，作为货币和金融的数字化转型趋势，CBDC 所面对的是一个更广阔的 Web3 世界。

* **“商业银行”的稳定币 （USDC vs USDT）**

Tether和Circle是两家发行稳定币的“商业银行”。他们在现实中吸收美元储蓄，并同时将 1：1 发放各条链上的稳定币作为“银行存款证明”。链上的交易由各条链负责，链下的存取款则由这两家“银行”负责。他们会用美元进行购买低风险债，同时也接受 SEC 的监管。

此外，合规性更好的 USDC 有取代 USDT 的趋势。同时 Circle 于7月1日官宣推出欧元稳定币，Euro Coin，机制和USDC一样，完全由欧元法币抵押产生。

![](.gitbook/assets/17)

资料来源：CMC

**小结**

稳定币作为 Web3 经济中的一般等价物或许还有新的迭代。但是稳定币迄今的历史选择了“商业银行”的稳定币。或许这是我们当下平衡两个世界的最好手段。

**各稳定币流通量**

![](.gitbook/assets/18)

资料来源：Dune（截至2022.6）\
https://dune.com/alirezaananas/stable-coin

#### 第 6 节 区块链浏览器：Scan、索引查询、数据分析

区块链上的每一笔交易都是数据，所以链上的数据是很多的。但是对于庞杂的数据的收集整理和查找的功能严重不足。所以在这方面的项目还非常有限，并有很大空间。

**6.1 Scan**

区块链浏览器是供用户查询所有区块链信息的工具。一般由公链的相关方开发，比如 ETH 的 ethscan 以及其他公链的 scan 浏览器。架构简单，主要用于链上数据的基础展示。

![](.gitbook/assets/19)

资料来源：秘猿科技\
https://www.zhihu.com/question/293505338

**6.2 索引**

在现实世界的索引查询是由 Google 通过爬虫建立的数据库实现的。但是在区块链的特性却使这一功能异常难以完成。而以 The Graph 为主的索引应用试图建立链上的数据索引“路线图”。

![](.gitbook/assets/20)

资料来源：The Graph 白皮书

https://thegraph.com/docs/zh/about/introduction/

**6.3 数据收集分析**

在链上数据的易得可视上，很多网站都想成为链上的“Bloomberg”。例如，提供全面的区块链链上数据的 Glassnode；提供公链、NFT、DeFi、稳定币等各种图表指标的Tokenview；分析并标记以太坊地址的链上活动的 Nansen；由社区贡献，提供大量数据分析仪表板的 Dune Analytics。（详见 PANews：《常用区块链数据工具网站汇总》

https://www.panewslab.com/zh/articledetails/1639654376071749.html）

#### 总结

以上的六个赛道只是当前比较主流的区块链扩展方向。当然区块链和 Web3 所需要的还远远不止这些。特别是在 Web3 的规模进一步扩大之后，会有更多的细分领域产生经济效应，提前布局或者应时开发，都可能是不错的选择。
